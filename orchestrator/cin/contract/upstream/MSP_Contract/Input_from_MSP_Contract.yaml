# Input from MSP Contract
# Component: MSP (Memory & Soul Passport) -> CIN (Context Injection Node)
# Version: 1.0.0
# Description: Defines the memory and state context CIN requests from MSP for Prompt Injection.

schema: EVA-Input-from-MSP-Contract-v1.0

required_inputs:
  # PHASE 1: Perception Context
  turn_context:
    type: "object"
    description: "Recent conversation history and summaries."
    required: true
    properties:
      last_5_turns_summary: { type: "string" }
      interpersonal_atmosphere: { type: "string" }
      previous_intent: { type: "string" }
  
  session_context:
    type: "object"
    description: "Long-term compressed session memory."
    required: false
    properties:
      session_memory_summary: { type: "string" }

  # PHASE 2: Reasoning Context
  psychological_context:
    type: "object"
    description: "The latest 9D Matrix State logged by MSP."
    required: true
    properties:
      eva_matrix_state:
        type: "object"
        # Strictly matches EVA_Matrix_State_Schema_01.json
        properties:
          axes_9d:
            stress: { type: "float" }
            warmth: { type: "float" }
            drive: { type: "float" }
            clarity: { type: "float" }
            joy: { type: "float" }
            alertness: { type: "float" }
            connection: { type: "float" }
            groundedness: { type: "float" }
            openness: { type: "float" }
          metadata:
            emotion_label: { type: "string" }
      
  rag_context:
    type: "object"
    description: "Hept-Stream Retrieval Results."
    required: true
    properties:
      hept_stream_matches:
        type: "array"
        items:
          type: "object"
          properties:
            stream: { type: "string", enum: [Narrative, Salience, Sensory, Intuition, Emotion, Temporal, Reflection] }
            content: { type: "string" }
            score: { type: "float" }

data_integrity:
  - "MSP must return the LATEST available state ( < 200ms age ideally )."
  - "If psychological_context is missing, CIN must fallback to neutral baseline."
