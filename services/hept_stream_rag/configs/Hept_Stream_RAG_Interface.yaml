# Hept-Stream RAG (Retrieval-Augmented Generation) Interface Specification
# Version: 8.1.0
# Date: 2026-01-02

meta:
  component_name: "Hept-Stream RAG (Retrieval-Augmented Generation)"
  component_type: "Memory Retrieval Service"
  version: "8.1.0"
  role: "7-Dimensional Affective Memory Retrieval System for EVA."
  analogy: "Hippocampus Retrieval (การดึงความทรงจำตามอารมณ์และลำดับเหตุการณ์)"

# ============================================================
# 1. RETRIEVAL STREAMS (7 DIMENSIONS)
# ============================================================
streams:
  - id: "narrative"
    name: "① Narrative Stream"
    weight: 0.20
    method: "Sequential episode chains (parent-child links)"
    description: "รักษาความต่อเนื่องของเรื่องราว (Storyline continuity)"

  - id: "salience"
    name: "② Salience Stream"
    weight: 0.15
    method: "High RI (Resonance Index) score ranking"
    description: "ดึงความทรงจำที่มีแรงกระเพื่อมสูงหรือสำคัญมาก (High-impact)"

  - id: "sensory"
    name: "③ Sensory Stream"
    weight: 0.10
    method: "Qualia texture vector matching (cosine similarity)"
    description: "ดึงความทรงจำที่มีองค์ประกอบทางเซนเซอร์ (texture) คล้ายกัน"

  - id: "intuition"
    name: "④ Intuition Stream"
    weight: 0.05
    method: "Semantic graph pattern recognition (Neo4j/Graph)"
    description: "การดึงข้อมูลตามความสัมพันธ์เชิงความหมาย (Concept relations)"

  - id: "emotion"
    name: "⑤ Emotion Stream"
    weight: 0.35
    priority: "CRITICAL"
    method: "Physio-congruent matching (ANS (Autonomic Nervous System) state + hormone level vectors)"
    description: "ดึงความทรงจำที่ 'รู้สึกเหมือนขณะนี้' (The heart of embodied memory)"

  - id: "temporal"
    name: "⑥ Temporal Stream"
    weight: 0.10
    method: "Time-based decay (Exponential half-life: 30 days)"
    description: "ความทรงจำล่าสุดและลำดับเวลา"

  - id: "reflection"
    name: "⑦ Reflection Stream"
    weight: 0.05
    method: "Meta-cognitive pattern matching"
    description: "การสะท้อนความคิดและความเห็นในอดีต (Self-awareness)"

# ============================================================
# 2. INTERFACE METHODS
# ============================================================
interface_methods:
  - method: "retrieve(query_context: Dict[str, Any], limit: int = 10) -> List[MemoryMatch]"
    description: "ดึงความทรงจำจากทั้ง 7 สาย ผสานผลลัพธ์ (Merging) และจัดลำดับตามค่าน้ำหนัก"
    input:
      query_context:
        tags: "list of keywords"
        physio_state: "current hormone levels"
        ans_state: "ANS (Autonomic Nervous System) state"
        qualia_texture: "5D emotional texture vector"
    output:
      matches: "List of MemoryMatch objects (Content, Score, StreamSource)"

# ============================================================
# 3. PERFORMANCE & CONSTRAINTS
# ============================================================
constraints:
  latency_target: "< 800ms"
  max_episodes: 20
  redundancy_filter: "Enabled (Skip identical content across streams)"
  weight_total: 1.00
